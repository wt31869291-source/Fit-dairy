<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å¥åº·æ—¥è¨˜ - Health Diary</title>
    <style>
        :root {
            --bg-color: #fdfcf8;
            --text-color: #4a4a4a;
            --primary-green: #a3b18a;
            --primary-blue: #9eb3c2;
            --period-pink: #eac4d5;
            --warning-orange: #e6a27e;
            --card-bg: #ffffff;
        }

        body {
            font-family: sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding-bottom: 80px;
        }

        /* å°è¦½èˆ‡é é¢æ§åˆ¶ */
        .page { display: none; padding: 20px; }
        .page.active { display: block; }
        
        header { padding: 10px 0; border-bottom: 1px solid #eee; margin-bottom: 20px; }

        /* åœ“é¤…åœ–æ¨£å¼ */
        .chart-container {
            position: relative;
            width: 200px;
            height: 200px;
            margin: 20px auto;
            border-radius: 50%;
            background: conic-gradient(var(--primary-green) 0%, #eee 0%);
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .chart-inner {
            width: 150px;
            height: 150px;
            background: var(--card-bg);
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
        }

        /* æœˆæ›†æ¨£å¼ */
        .calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 5px; }
        .calendar-day { 
            aspect-ratio: 1; border: 1px solid #eee; border-radius: 8px;
            display: flex; align-items: center; justify-content: center; position: relative; cursor: pointer;
        }
        .calendar-day.selected { border: 2px solid var(--primary-blue); background: #f0f0f0; }
        .dot { width: 6px; height: 6px; border-radius: 50%; position: absolute; top: 4px; right: 4px; }
        .dot-red { background: red; }
        
        /* è¡¨å–®æ¨£å¼ */
        .input-group { margin-bottom: 15px; }
        input, select { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 8px; box-sizing: border-box; }
        
        /* åº•éƒ¨å°è¦½ */
        .bottom-nav {
            position: fixed; bottom: 0; width: 100%; height: 70px;
            background: white; display: flex; justify-content: space-around; align-items: center;
            border-top: 1px solid #eee;
        }
        .nav-item { text-decoration: none; font-size: 1.5rem; color: #888; text-align: center; }
        .nav-item span { display: block; font-size: 0.7rem; }
        .nav-item.active { color: var(--primary-blue); }
    </style>
</head>
<body>

    <div id="page-home" class="page active">
        <header><h2>å¥åº·æ—¥è¨˜</h2></header>
        <div class="chart-container" id="main-circle">
            <div class="chart-inner">
                <small>å‰©é¤˜ç†±é‡</small>
                <strong id="remain-kcal">2000</strong>
                <small>kcal</small>
            </div>
        </div>
        <div style="display: flex; justify-content: space-around; text-align: center;">
            <div><b id="home-eat">0</b><br><small>æ”å–</small></div>
            <div><b id="home-burn">0</b><br><small>æ¶ˆè€—</small></div>
            <div><b id="home-water">0</b><br><small>é£²æ°´(mL)</small></div>
        </div>
    </div>

    <div id="page-record" class="page">
        <header><h3>æ—¥æœŸé¸æ“‡</h3></header>
        <div class="calendar-grid" id="calendar"></div>
        <div id="day-detail" style="margin-top:20px; display:none;">
            <hr>
            <h4 id="selected-date-title">æ—¥æœŸ</h4>
            <div class="input-group">
                <label>é£²é£Ÿæ”å– (kcal)</label>
                <input type="number" id="input-food" placeholder="è¼¸å…¥ç†±é‡">
            </div>
            <div class="input-group">
                <label>é£²æ°´é‡ (mL)</label>
                <input type="number" id="input-water" placeholder="è¼¸å…¥mL">
            </div>
            <div class="input-group">
                <label>é‹å‹•æ¶ˆè€— (kcal)</label>
                <input type="number" id="input-sport" placeholder="è¼¸å…¥æ¶ˆè€—">
            </div>
            <button onclick="saveData()" style="width:100%; padding:10px; background:var(--primary-blue); color:white; border:none; border-radius:8px;">å„²å­˜ç•¶æ—¥ç´€éŒ„</button>
        </div>
    </div>

    <div id="page-chart" class="page">
        <header><h3>æ•¸æ“šåˆ†æ</h3></header>
        <p>åœ–è¡¨åŠŸèƒ½é–‹ç™¼ä¸­ï¼šé€™è£¡å°‡é¡¯ç¤ºæ‚¨çš„é«”é‡èˆ‡ç†±é‡æ³¢å‹•æ³¢ç·šåœ–ã€‚</p>
    </div>

    <div id="page-profile" class="page">
        <header><h3>å€‹äººè³‡æ–™è¨­å®š</h3></header>
        <div class="input-group"><label>æ€§åˆ¥</label><select id="user-gender"><option>å¥³</option><option>ç”·</option></select></div>
        <div class="input-group"><label>èº«é«˜ (cm)</label><input type="number" id="user-height"></div>
        <div class="input-group"><label>é«”é‡ (kg)</label><input type="number" id="user-weight"></div>
        <div class="input-group"><label>å¹´é½¡</label><input type="number" id="user-age"></div>
        <button onclick="saveProfile()" style="width:100%; padding:10px; background:var(--primary-green); color:white; border:none; border-radius:8px;">å„²å­˜è¨­å®š</button>
    </div>

    <nav class="bottom-nav">
        <a href="javascript:void(0)" class="nav-item active" onclick="nav('home')">ğŸ <span>é¦–é </span></a>
        <a href="javascript:void(0)" class="nav-item" onclick="nav('record')">ğŸ“<span>ç´€éŒ„</span></a>
        <a href="javascript:void(0)" class="nav-item" onclick="nav('chart')">ğŸ“ˆ<span>åœ–è¡¨</span></a>
        <a href="javascript:void(0)" class="nav-item" onclick="nav('profile')">ğŸ‘¤<span>å€‹äºº</span></a>
    </nav>

    <script>
        let db = JSON.parse(localStorage.getItem('healthDiaryDB')) || {};
        let selectedDate = null;
        let profile = JSON.parse(localStorage.getItem('healthProfile')) || { target: 2000 };

        function nav(page) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            document.getElementById('page-' + page).classList.add('active');
            event.currentTarget.classList.add('active');
            if(page === 'home') updateHome();
        }

        function renderCalendar() {
            const cal = document.getElementById('calendar');
            cal.innerHTML = '';
            for(let i=1; i<=31; i++) {
                const dateKey = `2026-01-${i.toString().padStart(2, '0')}`;
                const hasData = db[dateKey];
                const dayEl = document.createElement('div');
                dayEl.className = 'calendar-day';
                dayEl.innerHTML = i + (hasData ? '<div class="dot dot-red"></div>' : '');
                dayEl.onclick = () => selectDate(dateKey, dayEl);
                cal.appendChild(dayEl);
            }
        }

        function selectDate(date, el) {
            selectedDate = date;
            document.querySelectorAll('.calendar-day').forEach(d => d.classList.remove('selected'));
            el.classList.add('selected');
            document.getElementById('day-detail').style.display = 'block';
            document.getElementById('selected-date-title').innerText = date;
            
            const data = db[date] || { food: '', water: '', sport: '' };
            document.getElementById('input-food').value = data.food;
            document.getElementById('input-water').value = data.water;
            document.getElementById('input-sport').value = data.sport;
        }

        function saveData() {
            db[selectedDate] = {
                food: Number(document.getElementById('input-food').value),
                water: Number(document.getElementById('input-water').value),
                sport: Number(document.getElementById('input-sport').value)
            };
            localStorage.setItem('healthDiaryDB', JSON.stringify(db));
            alert('ç´€éŒ„å·²å„²å­˜ï¼');
            renderCalendar();
        }

        function saveProfile() {
            const p = {
                gender: document.getElementById('user-gender').value,
                height: document.getElementById('user-height').value,
                weight: document.getElementById('user-weight').value,
                age: document.getElementById('user-age').value,
                target: 2000 // ç°¡åŒ–ç‰ˆç›®æ¨™
            };
            localStorage.setItem('healthProfile', JSON.stringify(p));
            profile = p;
            alert('è¨­å®šå·²æ›´æ–°ï¼');
        }

        function updateHome() {
            const today = new Date().toISOString().split('T')[0];
            const data = db[today] || { food: 0, water: 0, sport: 0 };
            const target = profile.target || 2000;
            const remain = target - data.food + data.sport;
            
            document.getElementById('remain-kcal').innerText = remain;
            document.getElementById('home-eat').innerText = data.food;
            document.getElementById('home-burn').innerText = data.sport;
            document.getElementById('home-water').innerText = data.water;
            
            const percent = Math.min((data.food / target) * 100, 100);
            document.getElementById('main-circle').style.background = `conic-gradient(var(--primary-green) ${percent}%, #eee 0%)`;
        }

        renderCalendar();
        updateHome();
    </script>
</body>
</html>
